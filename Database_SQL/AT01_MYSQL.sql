
CREATE TABLE vendas (
 id_nf INT,
 id_item INT,
 cod_prod INT,
 valor_unit DECIMAL(10, 2),
 quantidade INT,
 desconto DECIMAL(5, 2)
);


===============================================================================================//


INSERT INTO vendas (id_nf, id_item, cod_prod, valor_unit, quantidade, desconto) VALUES

 -> (1, 1, 1, 25.00, 10, 5),
 -> (1, 2, 2, 13.50, 3, NULL),
 -> (1, 3, 3, 15.00, 2, NULL),
 -> (1, 4, 4, 10.00, 1, NULL),
 -> (1, 5, 5, 30.00, 1, NULL),
 -> (2, 1, 1, 25.00, 5, NULL),
 -> (2, 2, 2, 13.50, 5, NULL),
 -> (2, 3, 3, 15.00, 4, NULL),
 -> (2, 4, 4, 10.00, 5, NULL),
 -> (2, 5, 5, 30.00, 7, NULL),
 -> (3, 1, 1, 25.00, 5, NULL),
 -> (3, 2, 2, 13.50, 7, NULL),
 -> (3, 3, 3, 15.00, 6, NULL),
 -> (3, 4, 4, 10.00, 5, NULL),
 -> (3, 5, 5, 30.00, 7, NULL),
 -> (4, 1, 1, 25.00, 10, NULL),
 -> (4, 2, 2, 13.50, 12, NULL),
 -> (4, 3, 3, 15.00, 15, NULL),
 -> (4, 4, 4, 10.00, 5, NULL),
 -> (4, 5, 5, 30.00, 10, 15),
 -> (5, 1, 1, 25.00, 13, 5),
 -> (5, 2, 2, 13.50, 15, 5),
 -> (5, 3, 3, 15.00, 3, 5),
 -> (5, 4, 4, 10.00, 6, NULL),
 -> (5, 5, 5, 30.00, 22, NULL),
 -> (6, 1, 1, 25.00, 25, 15),
 -> (6, 2, 2, 13.50, 20, 20),
 -> (7, 1, 1, 25.00, 10, 3),
 -> (7, 2, 2, 13.50, 10, 4),
 -> (7, 3, 3, 15.00, 10, 4),
 -> (7, 4, 5, 30.00, 10, 1);


===============================================================================================//

 

mysql> SELECT *
 -> FROM vendas
 -> WHERE id_nf = 7;
+-------+---------+----------+------------+------------+----------+
| id_nf | id_item | cod_prod | valor_unit | quantidade | desconto |
+-------+---------+----------+------------+------------+----------+
| 7 | 1 | 1 | 25.00 | 10 | 3.00 |
| 7 | 2 | 2 | 13.50 | 10 | 3.00 |
| 7 | 3 | 3 | 15.00 | 10 | 3.00 |
| 7 | 4 | 5 | 30.00 | 10 | 3.00 |
| 7 | 1 | 1 | 25.00 | 10 | 3.00 |
| 7 | 2 | 2 | 13.50 | 10 | 4.00 |
| 7 | 3 | 3 | 15.00 | 10 | 4.00 |
| 7 | 4 | 5 | 30.00 | 10 | 1.00 |
+-------+---------+----------+------------+------------+----------+


===============================================================================================//


SELECT *
 -> FROM vendas
 -> WHERE id_nf = 7
 -> ORDER BY valor_unit DESC;
+-------+---------+----------+------------+------------+----------+
| id_nf | id_item | cod_prod | valor_unit | quantidade | desconto |
+-------+---------+----------+------------+------------+----------+
| 7 | 4 | 5 | 30.00 | 10 | 3.00 |
| 7 | 4 | 5 | 30.00 | 10 | 1.00 |
| 7 | 1 | 1 | 25.00 | 10 | 3.00 |
| 7 | 1 | 1 | 25.00 | 10 | 3.00 |
| 7 | 3 | 3 | 15.00 | 10 | 3.00 |
| 7 | 3 | 3 | 15.00 | 10 | 4.00 |
| 7 | 2 | 2 | 13.50 | 10 | 3.00 |
| 7 | 2 | 2 | 13.50 | 10 | 4.00 |
+-------+---------+----------+------------+------------+----------+


===============================================================================================//


mysql> SELECT id_nf, id_item, cod_prod, valor_unit
 -> FROM vendas
 -> WHERE id_nf = 7
 -> ORDER BY valor_unit DESC;
+-------+---------+----------+------------+
| id_nf | id_item | cod_prod | valor_unit |
+-------+---------+----------+------------+
| 7 | 4 | 5 | 30.00 |
| 7 | 4 | 5 | 30.00 |
| 7 | 1 | 1 | 25.00 |
| 7 | 1 | 1 | 25.00 |
| 7 | 3 | 3 | 15.00 |
| 7 | 3 | 3 | 15.00 |
| 7 | 2 | 2 | 13.50 |
| 7 | 2 | 2 | 13.50 |
+-------+---------+----------+------------+


===============================================================================================//


mysql> SELECT *
 -> FROM vendas
 -> WHERE valor_unit = (SELECT MAX(valor_unit) FROM vendas);
+-------+---------+----------+------------+------------+----------+
| id_nf | id_item | cod_prod | valor_unit | quantidade | desconto |
+-------+---------+----------+------------+------------+----------+
| 1 | 5 | 5 | 30.00 | 4 | NULL |
| 2 | 5 | 5 | 30.00 | 7 | NULL |
| 3 | 5 | 5 | 30.00 | 7 | NULL |
| 4 | 5 | 5 | 30.00 | 10 | NULL |
| 5 | 5 | 5 | 30.00 | 22 | 15.00 |
| 7 | 4 | 5 | 30.00 | 10 | 3.00 |
| 1 | 5 | 5 | 30.00 | 1 | NULL |
| 2 | 5 | 5 | 30.00 | 7 | NULL |
| 3 | 5 | 5 | 30.00 | 7 | NULL |
| 4 | 5 | 5 | 30.00 | 10 | 15.00 |
| 5 | 5 | 5 | 30.00 | 22 | NULL |
| 7 | 4 | 5 | 30.00 | 10 | 1.00 |
+-------+---------+----------+------------+------------+----------+


===============================================================================================//


mysql> SELECT DISTINCT id_nf
 -> FROM vendas
 -> WHERE id_nf != 7;
+-------+
| id_nf |
+-------+
| 1 |
| 2 |
| 3 |
| 4 |
| 5 |
| 6 |
+-------+


===============================================================================================//


mysql> SELECT id_nf, id_item, cod_prod, quantidade
 -> FROM vendas
 -> WHERE id_nf = 1 AND quantidade >= 3
 -> ORDER BY quantidade ASC;
+-------+---------+----------+------------+
| id_nf | id_item | cod_prod | quantidade |
+-------+---------+----------+------------+
| 1 | 2 | 2 | 3 |
| 1 | 2 | 2 | 3 |
| 1 | 5 | 5 | 4 |
| 1 | 1 | 1 | 10 |
| 1 | 1 | 1 | 10 |
+-------+---------+----------+------------+


===============================================================================================//


mysql> SELECT id_nf, id_item, cod_prod, valor_unit
 -> FROM vendas
 -> WHERE desconto IS NULL;
+-------+---------+----------+------------+
| id_nf | id_item | cod_prod | valor_unit |
+-------+---------+----------+------------+
| 1 | 2 | 2 | 13.50 |
| 1 | 3 | 3 | 15.00 |
| 1 | 4 | 4 | 10.00 |
| 1 | 5 | 5 | 30.00 |
| 2 | 1 | 1 | 25.00 |
| 2 | 2 | 2 | 13.50 |
| 2 | 3 | 3 | 15.00 |
| 2 | 4 | 4 | 10.00 |
| 2 | 5 | 5 | 30.00 |
| 3 | 1 | 1 | 25.00 |
| 3 | 2 | 2 | 13.50 |
| 3 | 3 | 3 | 15.00 |
| 3 | 4 | 4 | 10.00 |
| 3 | 5 | 5 | 30.00 |
| 4 | 4 | 4 | 10.00 |
| 4 | 5 | 5 | 30.00 |
| 5 | 3 | 3 | 15.00 |
| 5 | 4 | 4 | 10.00 |
| 6 | 1 | 1 | 25.00 |
| 6 | 2 | 2 | 13.50 |
| 6 | 3 | 3 | 15.00 |
| 6 | 4 | 4 | 10.00 |
| 1 | 2 | 2 | 13.50 |
| 1 | 3 | 3 | 15.00 |
| 1 | 4 | 4 | 10.00 |
| 1 | 5 | 5 | 30.00 |
| 2 | 1 | 1 | 25.00 |
| 2 | 2 | 2 | 13.50 |
| 2 | 3 | 3 | 15.00 |
| 2 | 4 | 4 | 10.00 |
| 2 | 5 | 5 | 30.00 |
| 3 | 1 | 1 | 25.00 |
| 3 | 2 | 2 | 13.50 |
| 3 | 3 | 3 | 15.00 |
| 3 | 4 | 4 | 10.00 |
| 3 | 5 | 5 | 30.00 |
| 4 | 1 | 1 | 25.00 |
| 4 | 2 | 2 | 13.50 |
| 4 | 3 | 3 | 15.00 |
| 4 | 4 | 4 | 10.00 |
| 5 | 4 | 4 | 10.00 |
| 5 | 5 | 5 | 30.00 |
+-------+---------+----------+------------+


===============================================================================================//


mysql> SELECT id_nf, id_item, cod_prod, valor_unit, valor_unit - (valor_unit * (desconto / 100)) AS
valor_vendido
 -> FROM vendas
 -> WHERE desconto > 0;
+-------+---------+----------+------------+---------------+
| id_nf | id_item | cod_prod | valor_unit | valor_vendido |
+-------+---------+----------+------------+---------------+
| 1 | 1 | 1 | 25.00 | 23.75000000 |
| 4 | 1 | 1 | 25.00 | 21.25000000 |
| 4 | 2 | 2 | 13.50 | 12.82500000 |
| 4 | 3 | 3 | 15.00 | 14.25000000 |
| 5 | 1 | 1 | 25.00 | 23.75000000 |
| 5 | 2 | 2 | 13.50 | 12.82500000 |
| 5 | 5 | 5 | 30.00 | 25.50000000 |
| 7 | 1 | 1 | 25.00 | 24.25000000 |
| 7 | 2 | 2 | 13.50 | 13.09500000 |
| 7 | 3 | 3 | 15.00 | 14.55000000 |
| 7 | 4 | 5 | 30.00 | 29.10000000 |
| 1 | 1 | 1 | 25.00 | 23.75000000 |
| 4 | 5 | 5 | 30.00 | 25.50000000 |
| 5 | 1 | 1 | 25.00 | 23.75000000 |
| 5 | 2 | 2 | 13.50 | 12.82500000 |
| 5 | 3 | 3 | 15.00 | 14.25000000 |
| 6 | 1 | 1 | 25.00 | 21.25000000 |
| 6 | 2 | 2 | 13.50 | 10.80000000 |
| 7 | 1 | 1 | 25.00 | 24.25000000 |
| 7 | 2 | 2 | 13.50 | 12.96000000 |
| 7 | 3 | 3 | 15.00 | 14.40000000 |
| 7 | 4 | 5 | 30.00 | 29.70000000 |
+-------+---------+----------+------------+---------------+


===============================================================================================//


mysql> SELECT id_nf,
 -> id_item,
 -> cod_prod,
 -> valor_unit,
 -> desconto,
 -> valor_unit - (valor_unit * (desconto / 100)) AS valor_vendido,
 -> quantidade * (valor_unit - (valor_unit * (desconto / 100))) AS valor_final_item
 -> FROM vendas;
+-------+---------+----------+------------+----------+---------------+------------------+
| id_nf | id_item | cod_prod | valor_unit | desconto | valor_vendido | valor_final_item |
+-------+---------+----------+------------+----------+---------------+------------------+
| 1 | 1 | 1 | 25.00 | 5.00 | 23.75000000 | 237.50000000 |
| 1 | 2 | 2 | 13.50 | 0.00 | 13.50000000 | 40.50000000 |
| 1 | 3 | 3 | 15.00 | 0.00 | 15.00000000 | 30.00000000 |
| 1 | 4 | 4 | 10.00 | 0.00 | 10.00000000 | 10.00000000 |
| 1 | 5 | 5 | 30.00 | 0.00 | 30.00000000 | 120.00000000 |
| 2 | 1 | 1 | 25.00 | 0.00 | 25.00000000 | 125.00000000 |
| 2 | 2 | 2 | 13.50 | 0.00 | 13.50000000 | 67.50000000 |
| 2 | 3 | 3 | 15.00 | 0.00 | 15.00000000 | 60.00000000 |
| 2 | 4 | 4 | 10.00 | 0.00 | 10.00000000 | 50.00000000 |
| 2 | 5 | 5 | 30.00 | 0.00 | 30.00000000 | 210.00000000 |
| 3 | 1 | 1 | 25.00 | 0.00 | 25.00000000 | 100.00000000 |
| 3 | 2 | 2 | 13.50 | 0.00 | 13.50000000 | 67.50000000 |
| 3 | 3 | 3 | 15.00 | 0.00 | 15.00000000 | 90.00000000 |
| 3 | 4 | 4 | 10.00 | 0.00 | 10.00000000 | 50.00000000 |
| 3 | 5 | 5 | 30.00 | 0.00 | 30.00000000 | 210.00000000 |
| 4 | 1 | 1 | 25.00 | 15.00 | 21.25000000 | 212.50000000 |
| 4 | 2 | 2 | 13.50 | 5.00 | 12.82500000 | 153.90000000 |
| 4 | 3 | 3 | 15.00 | 5.00 | 14.25000000 | 213.75000000 |
| 4 | 4 | 4 | 10.00 | 0.00 | 10.00000000 | 50.00000000 |
| 4 | 5 | 5 | 30.00 | 0.00 | 30.00000000 | 300.00000000 |
| 5 | 1 | 1 | 25.00 | 5.00 | 23.75000000 | 308.75000000 |
| 5 | 2 | 2 | 13.50 | 5.00 | 12.82500000 | 192.37500000 |
| 5 | 3 | 3 | 15.00 | 0.00 | 15.00000000 | 45.00000000 |
| 5 | 4 | 4 | 10.00 | 0.00 | 10.00000000 | 60.00000000 |
| 5 | 5 | 5 | 30.00 | 15.00 | 25.50000000 | 561.00000000 |
| 6 | 1 | 1 | 25.00 | 0.00 | 25.00000000 | 625.00000000 |
| 6 | 2 | 2 | 13.50 | 0.00 | 13.50000000 | 270.00000000 |
| 6 | 3 | 3 | 15.00 | 0.00 | 15.00000000 | 150.00000000 |
| 6 | 4 | 4 | 10.00 | 0.00 | 10.00000000 | 40.00000000 |
| 7 | 1 | 1 | 25.00 | 3.00 | 24.25000000 | 242.50000000 |
| 7 | 2 | 2 | 13.50 | 3.00 | 13.09500000 | 130.95000000 |
| 7 | 3 | 3 | 15.00 | 3.00 | 14.55000000 | 145.50000000 |
| 7 | 4 | 5 | 30.00 | 3.00 | 29.10000000 | 291.00000000 |
| 1 | 1 | 1 | 25.00 | 5.00 | 23.75000000 | 237.50000000 |
| 1 | 2 | 2 | 13.50 | 0.00 | 13.50000000 | 40.50000000 |
| 1 | 3 | 3 | 15.00 | 0.00 | 15.00000000 | 30.00000000 |
| 1 | 4 | 4 | 10.00 | 0.00 | 10.00000000 | 10.00000000 |
| 1 | 5 | 5 | 30.00 | 0.00 | 30.00000000 | 30.00000000 |
| 2 | 1 | 1 | 25.00 | 0.00 | 25.00000000 | 125.00000000 |
| 2 | 2 | 2 | 13.50 | 0.00 | 13.50000000 | 67.50000000 |
| 2 | 3 | 3 | 15.00 | 0.00 | 15.00000000 | 60.00000000 |
| 2 | 4 | 4 | 10.00 | 0.00 | 10.00000000 | 50.00000000 |
| 2 | 5 | 5 | 30.00 | 0.00 | 30.00000000 | 210.00000000 |
| 3 | 1 | 1 | 25.00 | 0.00 | 25.00000000 | 125.00000000 |
| 3 | 2 | 2 | 13.50 | 0.00 | 13.50000000 | 94.50000000 |
| 3 | 3 | 3 | 15.00 | 0.00 | 15.00000000 | 90.00000000 |
| 3 | 4 | 4 | 10.00 | 0.00 | 10.00000000 | 50.00000000 |
| 3 | 5 | 5 | 30.00 | 0.00 | 30.00000000 | 210.00000000 |
| 4 | 1 | 1 | 25.00 | 0.00 | 25.00000000 | 250.00000000 |
| 4 | 2 | 2 | 13.50 | 0.00 | 13.50000000 | 162.00000000 |
| 4 | 3 | 3 | 15.00 | 0.00 | 15.00000000 | 225.00000000 |
| 4 | 4 | 4 | 10.00 | 0.00 | 10.00000000 | 50.00000000 |
| 4 | 5 | 5 | 30.00 | 15.00 | 25.50000000 | 255.00000000 |
| 5 | 1 | 1 | 25.00 | 5.00 | 23.75000000 | 308.75000000 |
| 5 | 2 | 2 | 13.50 | 5.00 | 12.82500000 | 192.37500000 |
| 5 | 3 | 3 | 15.00 | 5.00 | 14.25000000 | 42.75000000 |
| 5 | 4 | 4 | 10.00 | 0.00 | 10.00000000 | 60.00000000 |
| 5 | 5 | 5 | 30.00 | 0.00 | 30.00000000 | 660.00000000 |
| 6 | 1 | 1 | 25.00 | 15.00 | 21.25000000 | 531.25000000 |
| 6 | 2 | 2 | 13.50 | 20.00 | 10.80000000 | 216.00000000 |
| 7 | 1 | 1 | 25.00 | 3.00 | 24.25000000 | 242.50000000 |
| 7 | 2 | 2 | 13.50 | 4.00 | 12.96000000 | 129.60000000 |
| 7 | 3 | 3 | 15.00 | 4.00 | 14.40000000 | 144.00000000 |
| 7 | 4 | 5 | 30.00 | 1.00 | 29.70000000 | 297.00000000 |
+-------+---------+----------+------------+----------+---------------+------------------+




